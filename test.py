import xml.etree.ElementTree as ET
import os

def build_parent_map(element):
    parent_map = {}
    for child in element.iter():
        for subchild in child:
            parent_map[subchild] = child
    return parent_map

# Build the parent ma
def main():
    # Đường dẫn đến thư mục chứa AndroidManifest.xml
    manifest_dir = b"AndroGoat/AndroidManifest.xml"
    tree = ET.parse(manifest_dir)

    root = tree.getroot()
    parent_map = build_parent_map(root)

    # Find all containers and iterate through them
    containers = root.findall(".//activity/intent-filter/action")
    for child in containers:
        # Get the parent of the current child
        parent = parent_map.get(child)

        # Now, you can use 'parent' as you need
        # For example, print the tag of the parent
        print(parent_map.get(parent).tag)

    # containers = root.findall(".//activity/intent-filter")
    # for child in containers:
    #         print(child.getchildren())
   
if __name__ == "__main__":
    main()

